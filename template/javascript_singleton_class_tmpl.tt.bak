let [% instance_variable_name %];

[% namespace_declaration_content %]
// var MedImmune = MedImmune || {};
// MedImmune.BDM = MedImmune.BDM || {};
// MedImmune.BDM.CreateCollection = MedImmune.BDM.CreateCollection || {};
// MedImmune.BDM.CreateCollection.Webapp = MedImmune.BDM.CreateCollection.Webapp || {};

/*
  Object definition using the JavaScript Module Design Pattern 
*/

[% namespace %] = (function(){

    var create = function(){

        [% constants_content %]

        [% dependencies_variables_content %]
        // var appUtil;
        // var appViewController;
        // var appInitializer;
        // var lightbox;
        // var server;
        // var loginManager;

        const _init = function (){
        
            [% dependencies_instantiations_content %]

         //    lightbox = MedImmune.BDM.Lightbox.getInstance();

    	    // appUtil = MedImmune.BDM.App.Util.getInstance();
         //    if (!defined(appUtil)){
         //        throw new Error("Could not instantiate MedImmune.BDM.App.Util");
         //    }

         //    server = MedImmune.BDM.CreateCollection.Server.getInstance();
         //    if (!defined(server)){
         //        throw new Error("Could not instantiate MedImmune.BDM.CreateCollection.Server");
         //    }

    	    // appInitializer = MedImmune.BDM.CreateCollection.WebApp.Initializer.getInstance();
         //    if (!defined(appInitializer)){
         //        throw new Error("Could not instantiate MedImmune.BDM.CreateCollection.WebApp.Initializer");
         //    }

    	    // appViewController = MedImmune.BDM.CreateCollection.WebApp.View.Controller.getInstance();
         //    if (!defined(appViewController)){
         //        throw new Error("Could not instantiate MedImmune.BDM.CreateCollection.WebApp.View.Controller");
         //    }            

    	    // loginManager = MedImmune.BDM.LoginManager.getInstance();
         //    if (!defined(loginManager)){
         //        throw new Error("Could not instantiate MedImmune.BDM.LoginManager");
         //    }            

        };

        [% private_functions_content %]

        [% public_functions_content %]
        // var run = function (){

    	   //  _init();

        //     loginManager.displayUI();
        // }


        // var run2 = function (){
            
        //     /* 
        //        The user has been successfully logged in.
        //        Go ahead and initialize the UI.
        //     */

        //     try {
        //         appInitializer.initialize();
        //     }
        //     catch (ex){
        //         throw new Error("Caught some exception: '" + ex.message + "' at line number '" + ex.lineNumber + 
        //                         "' in file '" + ex.fileName + "'.  Please contact the administrator '__ADMIN_EMAIL_ADDRESS__'.");
        //     }

        //     try {
                
	       //  //appViewController.displayPlanDashboard();
        //     }
        //     catch (ex){
        //         throw new Error("Caught some exception: '" + ex.message + "' at line number '" + ex.lineNumber +
        //                         "' in file '" + ex.fileName + "'.  Please contact the administrator '__ADMIN_EMAIL_ADDRESS__'.");
        //     }
        // }


         return {
            [% return_function_list_content %]
             // run: run,
             // run2: run2
        };
    };
    
    return {

        getInstance: function(){

            if(![% instance_variable_name %]){
                
                try {
                    [% instance_variable_name %] = create(); 
                }
                catch (ex){
                    alert("Caught an exception : " + ex + " during invocation of [% namespace %].create()");
                }
            }
            
            return [% instance_variable_name %]; 
        }
    };
})();